# config.py
import os
from dotenv import load_dotenv

# Load .env file
load_dotenv()

# --- Application Settings ---
APP_TITLE = os.getenv("APP_TITLE", "Faucet Maintenance Prototype")
DB_PATH = os.getenv("DB_PATH", "prototype.db")

# --- User Management ---
# USERS string: "admin:admin:admin123,tech:technician:tech123"
USERS_RAW = os.getenv("USERS", "admin:admin:admin123,tech:technician:tech123")
USERS = {}
for token in [t.strip() for t in USERS_RAW.split(",") if t.strip()]:
    try:
        uname, role, pwd = token.split(":")
        USERS[uname] = {"role": role, "password": pwd}
    except ValueError:
        pass

# --- File Upload Settings ---
MAX_FILE_SIZE_MB = float(os.getenv("MAX_FILE_SIZE_MB", "10"))
ALLOWED_TYPES = [t.strip().lower() for t in os.getenv("ALLOWED_TYPES", "jpg,jpeg,png").split(",")]

# --- Business Logic Settings ---
EDIT_WINDOW_MINUTES = int(os.getenv("EDIT_WINDOW_MINUTES", "60"))

# --- Google API Settings ---
GOOGLE_MAPS_API_KEY = os.getenv("GOOGLE_MAPS_API_KEY", "")
USE_VISION = os.getenv("USE_VISION", "true").lower() in ("1", "true", "yes")

# --- Default Values ---
DEFAULT_LAT = float(os.getenv("DEFAULT_LAT", "30.0444"))
DEFAULT_LON = float(os.getenv("DEFAULT_LON", "31.2357"))

# --- Hardcoded Constants ---
FACILITY_TYPES = ["مسجد", "كنيسة", "مدرسة", "غير ذلك"]
FACILITY_DESCRIPTIONS = ["منشأة منفردة", "تحتوي على حديقة", "بها دار مناسبات"]
MAINT_TYPES = ["تركيب صنبور موفر للمرة الأولى", "تغيير صنبور موفر تالف"]

# --- Location Data ---
EGYPT_LOCATIONS = {
    "القاهرة": { "districts": { "القاهرة": ["مصر الجديدة", "المعادي", "الزمالك", "وسط البلد", "شبرا", "الدقي", "المهندسين", "النزهة", "مدينة نصر", "الرحاب"]}},
    "الجيزة": { "districts": { "الجيزة": ["الدقي", "المهندسين", "العجوزة", "الزمالك", "بولاق الدكرور", "إمبابة"], "6 أكتوبر": ["الحي الأول", "الحي الثاني", "الحي الثالث", "الحي الرابع", "الحي السابع", "الحي الثامن"], "الشيخ زايد": ["الحي الأول", "الحي الثاني", "الحي الثالث", "الحي السادس عشر"]}},
    "الإسكندرية": { "districts": { "الإسكندرية": ["المنتزه", "شرق", "وسط", "غرب", "الجمرك", "اللبان", "كرموز", "الدخيلة", "العجمي", "برج العرب"]}},
    "الدقهلية": { "districts": { "المنصورة": ["المنصورة", "طلخا", "شربين", "بلقاس", "السنبلاوين", "أجا", "منية النصر", "دكرنس", "المطرية", "نبروه"], "طلخا": ["طلخا", "فر البطيخ", "الكردي"], "شربين": ["شربين", "فر شربين", "الروضة"]}},
    "الشرقية": { "districts": { "الزقازيق": ["الزقازيق", "منيا القمح", "بلبيس", "مشتول السوق", "القنايات", "أبو حماد", "القرين", "ديرب نجم", "كفر صقر", "أولاد صقر"], "بلبيس": ["بلبيس", "العاشر من رمضان", "الصالحية الجديدة"], "منيا القمح": ["منيا القمح", "الصالحية"]}},
    "القليوبية": { "districts": { "بنها": ["بنها", "قها", "كفر شكر", "طوخ", "قليوب", "شبين القناطر", "الخانكة", "الخصوص", "شبرا الخيمة", "القناطر الخيرية"], "شبرا الخيمة": ["شبرا الخيمة", "الخلفاوي", "الساحل"], "قليوب": ["قليوب", "مسطرد", "الخصوص"]}},
    "الغربية": { "districts": { "طنطا": ["طنطا", "فر الزيات", "بسيون", "المحلة الكبرى", "زفتى", "السنطة", "سمنود", "قطور"], "المحلة الكبرى": ["المحلة الكبرى", "شبراخيت", "الباجور"], "فر الزيات": ["فر الزيات", "دسوق"]}},
    "المنوفية": { "districts": { "شبين الكوم": ["شبين الكوم", "الباجور", "قويسنا", "بركة السبع", "تلا", "الشهداء", "منوف", "السادات", "أشمون"], "منوف": ["منوف", "السادات"], "الباجور": ["الباجور", "فر داود"]}},
    "البحيرة": { "districts": { "دمنهور": ["دمنهور", "كفر الدوار", "رشيد", "إدكو", "أبو المطامير", "أبو حمص", "الدلنجات", "المحمودية", "الرحمانية", "شبراخيت"], "كفر الدوار": ["كفر الدوار", "المعمورة"], "رشيد": ["رشيد", "إدكو"]}},
    "الفيوم": { "districts": { "الفيوم": ["الفيوم", "سنورس", "إطسا", "طامية", "إبشواي", "يوسف الصديق"], "سنورس": ["سنورس", "فيديمين"], "طامية": ["طامية", "الكعابي الشرقي"]}},
    "بني سويف": { "districts": { "بني سويف": ["بني سويف", "الواسطى", "ناصر", "ببا", "الفشن", "إهناسيا", "سمسطا"], "الواسطى": ["الواسطى", "بياض العرب"], "ناصر": ["ناصر", "أبو صوير"]}},
    "المنيا": { "districts": { "المنيا": ["المنيا", "بني مزار", "مطاي", "سمالوط", "المدينة الجديدة", "العدوة", "مغاغة", "دير مواس", "ملوي", "أبو قرقاص"], "ملوي": ["ملوي", "أنصنا"], "مطاي": ["مطاي", "تلة"]}},
    "أسيوط": { "districts": { "أسيوط": ["أسيوط", "ديروط", "القوصية", "منفلوط", "أبو تيج", "الغنايم", "ساحل سليم", "البداري", "صدفا", "الفتح", "أبنوب"], "ديروط": ["ديروط", "الديروط الشريف"], "منفلوط": ["منفلوط", "أسيوط الجديدة"]}},
    "سوهاج": { "districts": { "سوهاج": ["سوهاج", "أخميم", "البلينا", "المراغة", "المنشأة", "دار السلام", "جهينة", "العسيرات", "ساقلتا", "طما", "طهطا"], "أخميم": ["أخميم", "الكوامل"], "طما": ["طما", "الهلالية"]}},
    "قنا": { "districts": { "قنا": ["قنا", "دشنا", "الوقف", "قفط", "قوص", "نقادة", "فرشوط", "أبو تشت", "نجع حمادي"], "قوص": ["قوص", "الأقصر"], "نجع حمادي": ["نجع حمادي", "الحميدات"]}},
    "الأقصر": { "districts": { "الأقصر": ["الأقصر", "إسنا", "الطود", "أرمنت", "القرنة", "البياضية"], "إسنا": ["إسنا", "الأحايوة"], "أرمنت": ["أرمنت", "الرزيقات"]}},
    "أسوان": { "districts": { "أسوان": ["أسوان", "دراو", "كوم أمبو", "نصر النوبة", "إدفو", "السباعية"], "إدفو": ["إدفو", "الرديسية"], "كوم أمبو": ["كوم أمبو", "نصر النوبة"]}}
}